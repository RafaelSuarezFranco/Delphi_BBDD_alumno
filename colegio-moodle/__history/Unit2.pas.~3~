unit Unit2;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, FireDAC.Stan.Intf, FireDAC.Stan.Option,
  FireDAC.Stan.Error, FireDAC.UI.Intf, FireDAC.Phys.Intf, FireDAC.Stan.Def,
  FireDAC.Stan.Pool, FireDAC.Stan.Async, FireDAC.Phys, FireDAC.Phys.MySQL,
  FireDAC.Phys.MySQLDef, FireDAC.VCLUI.Wait, FireDAC.Stan.Param, FireDAC.DatS,
  FireDAC.DApt.Intf, FireDAC.DApt, Data.DB, FireDAC.Comp.DataSet, Vcl.Grids,
  Vcl.DBGrids, FireDAC.Comp.Client, Vcl.StdCtrls;

type
  TPrincipal = class(TForm)
    FDConnection1: TFDConnection;
    DataSourceAlumno: TDataSource;
    FDTablealumno: TFDTable;
    DBGrid1: TDBGrid;
    FDTablealumnoid: TFDAutoIncField;
    FDTablealumnonombre: TStringField;
    FDTablealumnocurso: TStringField;
    FDTablealumnoexpediente: TIntegerField;
    FDTableNotas: TFDTable;
    DataSourceNotas: TDataSource;
    DBGrid2: TDBGrid;
    FDTableNotasexpediente: TIntegerField;
    FDTableNotascurso: TStringField;
    FDTableNotasnota: TSingleField;
    FDTableNotasfecha: TDateField;
    FDTableNotasasignatura: TStringField;
    FDTableNotasid: TFDAutoIncField;
    Label1: TLabel;
    ComboBox1: TComboBox;
    ButtonNota: TButton;
    ButtonHist: TButton;
    Buttontodos: TButton;
    ButtonAlta: TButton;
    ButtonBaja: TButton;
    procedure FormActivate(Sender: TObject);
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
    procedure ComboBox1Change(Sender: TObject);
    procedure DBGrid1DblClick(Sender: TObject);
    procedure ButtontodosClick(Sender: TObject);

  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Principal: TPrincipal;

implementation

{$R *.dfm}

procedure TPrincipal.ButtontodosClick(Sender: TObject);
begin
  fdtablenotas.Filtered := false;
end;

procedure TPrincipal.ComboBox1Change(Sender: TObject);
begin
if ComboBox1.Text <> 'Sin filtro' then
  begin
   fdtablenotas.Filtered:=true;
   fdtablenotas.Filter:='asignatura ='+quotedstr(ComboBox1.Text);
  end
  else
  begin
  fdtablenotas.Filtered:=false;
  end;

end;


procedure TPrincipal.DBGrid1DblClick(Sender: TObject);
begin
  fdtablenotas.Filtered := false;
  fdtablenotas.Filtered := true;
  fdtablenotas.Filter := 'expediente='+inttostr(fdtablealumnoexpediente.Value);
end;

procedure TPrincipal.FormActivate(Sender: TObject);
begin
fdtablealumno.open;
fdtablenotas.open;
ComboBox1.Items.LoadFromFile('asignaturas.txt');
ComboBox1.Items.Add('Sin filtro');
end;

procedure TPrincipal.FormClose(Sender: TObject; var Action: TCloseAction);
begin
   fdtablealumno.close;
   fdtablenotas.close;
end;


end.
